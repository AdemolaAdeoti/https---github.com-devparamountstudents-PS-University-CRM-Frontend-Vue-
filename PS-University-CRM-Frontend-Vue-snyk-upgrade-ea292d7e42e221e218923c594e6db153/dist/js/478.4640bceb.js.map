{"version":3,"file":"js/478.4640bceb.js","mappings":"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","sources":["webpack://university_crm/./src/views/settings/OldAgreementLetter.vue","webpack://university_crm/./src/views/settings/OldAgreementLetter.vue?051e","webpack://university_crm/./src/views/settings/Signature.vue","webpack://university_crm/./src/views/settings/Signature.vue?211d"],"sourcesContent":["<template>\r\n  <div v-if=\"userInfo.university.agreement_letter\" class=\"pdf-container\" style=\"overflow: auto;width:100%;height:100vh;\">\r\n    <div class=\"container d-flex\" v-if=\"userInfo.university.agreement_letter.url == null\">\r\n      <input @change=\"handleFileUpload\" type=\"file\" ref=\"myFileInput\" style=\"display: none\" />\r\n      <input type=\"button\" @click=\"$refs['myFileInput'].click()\" value=\"Choose file\" />\r\n      <button @click=\"showModal = true\" type=\"button\" class=\"ms-2\" tite=\"Digital Signature\">\r\n        <span v-html=\"$globals.icons.pen\" style=\"fill:#000\"></span>\r\n      </button>\r\n      <button @click=\"showTextFrame = true\" type=\"button\" class=\"ms-2 \" title=\"Add Text\">\r\n        <span style=\"fill:#000;font-weight:bold;font-size:1em\" >T</span>\r\n      </button>   \r\n      \r\n      <input v-if=\"this.canvasIndex > -1\" type=\"button\" @click=\"undo\" class=\"ms-2\" value=\"Undo\" />\r\n      <input type=\"button\" @click=\"submitSignedPdf\" class=\"ms-2\" value=\"Submit Document\" />\r\n    </div>\r\n    <div v-else>\r\n      <a :href=\"userInfo.university.agreement_letter.url\" download  class=\"ms-2 btn btn-secondary \" >\r\n        Download\r\n      </a>  \r\n    </div>\r\n    <div class=\"pdf-viewer position-relative\">\r\n      <div v-show=\"activateSign\" ref=\"draggableresizableimage\" class=\"ui-widget-content\" style=\"position:absolute;top:0px; width: 150px; height: 150px; padding: 0.5em\">\r\n        <img ref=\"signature\" id=\"signature\" src=\"\" alt=\"\" style=\"width: 100%; height: 100%\" />\r\n        <div class=\"l ui-resizable-handle ui-resizable-w resizable-wrapper\" id=\"w\"></div>\r\n        <div class=\"r ui-resizable-handle ui-resizable-e resizable-wrapper\" id=\"e\"></div>\r\n        <div class=\"tl ui-resizable-handle ui-resizable-nw\" id=\"nw\"></div>\r\n        <div class=\"tr ui-resizable-handle ui-resizable-ne\" id=\"ne\"></div>\r\n        <div class=\"bl ui-resizable-handle ui-resizable-sw\" id=\"sw\"></div>\r\n        <div class=\"br ui-resizable-handle ui-resizable-se\" id=\"se\"></div>\r\n        <button @click=\"attachSignature\" class=\"position-absolute btn bg-white\" style=\"color:rgb(255, 0, 106); border:1px solid rgb(255, 0, 106); left:0px;white-space:nowrap; bottom:-35px\">Insert Here</button>\r\n      </div>\r\n\r\n      <div v-show=\"showTextFrame\" ref=\"draggableresizableimage2\" class=\"ui-widget-content\" style=\"position:absolute;top:0px; width: 150px; height: 150px; padding: 0.5em\">\r\n        <div style=\"width:160%;display:flex\">\r\n          <textarea rows=\"1\" cols=\"40\" v-model=\"text.value\" :style=\"'font-size:'+text.fontSize+'px'\" style=\"border:1px solid rgb(255, 0, 106);background:transparent\" ></textarea>\r\n          <select v-model=\"text.fontSize\" style=\"width:50px\" class=\"form-control\">\r\n            <option value=\"10\">10</option>\r\n            <option value=\"14\">14</option>\r\n            <option value=\"16\">16</option>\r\n            <option value=\"20\">20</option>\r\n            <option value=\"24\">24</option>\r\n          </select>\r\n        </div>\r\n\r\n        <div class=\"l ui-resizable-handle ui-resizable-w resizable-wrapper\" id=\"w2\"></div>\r\n        <div class=\"r ui-resizable-handle ui-resizable-e resizable-wrapper\" id=\"e2\"></div>\r\n        <div class=\"tl ui-resizable-handle ui-resizable-nw\" id=\"nw2\"></div>\r\n        <div class=\"tr ui-resizable-handle ui-resizable-ne\" id=\"ne2\"></div>\r\n        <div class=\"bl ui-resizable-handle ui-resizable-sw\" id=\"sw2\"></div>\r\n        <div class=\"br ui-resizable-handle ui-resizable-se\" id=\"se2\"></div>\r\n        <button @click=\"attachText\" class=\"position-absolute btn bg-white\" style=\"color:rgb(255, 0, 106); border:1px solid rgb(255, 0, 106); left:20px;white-space:nowrap;bottom: 52px;\">Insert Here</button>\r\n      </div>\r\n      <div style=\"width:700px\"  v-for=\"(page, pageIndex) in pdfPages\" :key=\"pageIndex\" class=\"page-thumbnail mx-auto\" @mousemove=\"handleCanvasClick(pageIndex, $event)\">\r\n        <canvas :ref=\"'pageCanvas_' + pageIndex\" style=\"width:100%;\" height=\"200\"></canvas>\r\n      </div>\r\n    </div>\r\n    <!-- <button @click=\"submitSignedPdf\">Submit</button> -->\r\n    <div v-if=\"showModal\">\r\n      <div class=\"modal-overlay\" @click=\"closeModal\"></div>\r\n      <div class=\"modal-custom\">\r\n        <div class=\"modal-header\">\r\n          <button class=\"modal-close\" @click=\"closeModal\">X</button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <Signature @getSign=\"importSign($event)\"></Signature>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div v-else>\r\n    No Letter Found\r\n  </div>\r\n</template>\r\n  \r\n<script>\r\nimport { PDFDocument } from \"pdf-lib\";\r\nimport * as pdfjsLib from \"pdfjs-dist\";\r\nimport pdfjsWorker from \"pdfjs-dist/build/pdf.worker.entry\";\r\nimport Signature from \"@/views/settings/Signature.vue\";\r\nimport jquery from \"jquery\";\r\nimport \"jquery-ui-dist/jquery-ui\";\r\nimport { showModal } from \"@/plugins/modal\";\r\nimport { postFormData, post } from '@/api/client';\r\nconst $ = jquery;\r\nlet pdfDocument = null;\r\nexport default {\r\n  components: {\r\n    Signature,\r\n  },\r\n  data() {\r\n    return {\r\n      pdfData: null,\r\n      pdfUrl:null,\r\n      pdfPages: [], // Array to store loaded PDF pages\r\n      signaturePosition: null,\r\n      selectedPage: '',\r\n      showModal: false,\r\n      activateSign:false,\r\n      showTextFrame:false,\r\n      text: {\r\n        value: \"Your text here\",\r\n        fontSize: 14, \r\n        x:0,\r\n        y:0,\r\n        w:0,\r\n        h:0\r\n      },\r\n      sign: {\r\n        x: 0,\r\n        y: 0,\r\n        w: 0,\r\n        h: 0,\r\n        file: null,\r\n      },\r\n      pdfScale: 3,\r\n      userInfo:JSON.parse(localStorage.getItem('userInfo')||'{}'),\r\n      canvasHistory: [], // Array to store canvas states\r\n      canvasIndex: -1, // Current index in canvas history\r\n    };\r\n  },\r\n\r\n  methods: {\r\n    async handleCanvasClick(pageIndex) {\r\n      this.selectedPage = pageIndex;      \r\n      },\r\n  \r\n    handleFileUpload(event) {\r\n      const file = event.target.files[0];\r\n      if (file) {\r\n        this.$refs.signature.src = URL.createObjectURL(file);\r\n        this.sign.file = URL.createObjectURL(file);\r\n        this.activateSign = true\r\n        this.sign.w = 100;\r\n        this.sign.h = 100;\r\n      }\r\n    },\r\n    importSign(data) {\r\n      this.$refs[\"signature\"].src = data;\r\n      this.sign.w = 100;\r\n      this.sign.h = 100;\r\n      this.sign.file = data;\r\n      this.showModal = false;\r\n      this.activateSign = true\r\n    },\r\n    closeModal() {\r\n      this.showModal = false;\r\n      this.doc = \"\";\r\n    },\r\n    async loadPdf() {\r\n      this.pdfUrl = this.userInfo.university.agreement_letter.url!=null?this.userInfo.university.agreement_letter.url:this.userInfo.university.agreement_letter.template;      \r\n      this.pdfUrl = this.pdfUrl||'';      \r\n      try{ pdfjsLib.GlobalWorkerOptions.workerSrc = pdfjsWorker;\r\n      const loadingTask = pdfjsLib.getDocument({\r\n        url:this.pdfUrl,\r\n      });\r\n\r\n      pdfDocument = await loadingTask.promise;\r\n\r\n      this.pdfPages = Array.from(\r\n        { length: pdfDocument.numPages },\r\n        (_, pageIndex) => pdfDocument.getPage(pageIndex + 1)\r\n      );\r\n    }catch(e){\r\n      console.log(e)\r\n    }\r\n    },\r\n    async attachText() {\r\n      const canvas = this.$refs['pageCanvas_' + this.selectedPage][0];\r\n      const ctx = canvas.getContext(\"2d\");      \r\n\r\n      const canvasState = canvas.toDataURL();\r\n      this.canvasHistory.push(canvasState);\r\n      this.canvasIndex = this.canvasHistory.length - 1;\r\n      const text = this.text.value; // Get the text value from your data\r\n      const fontSize = this.text.fontSize; // Get the font size from your data\r\n      const font = `${fontSize*2.8 }px Arial`; // Use your desired font\r\n\r\n      const mx = this.pdfScale - 0.5;\r\n      const scaledX = this.text.x *mx+45;\r\n      const scaledY = this.text.y * mx+45;\r\n\r\n      ctx.font = font;\r\n      ctx.fillStyle = \"black\"; // Set the text color\r\n\r\n      // Draw the text on the canvas\r\n      ctx.fillText(text, scaledX, scaledY);\r\n\r\n      this.showTextFrame = false; // Hide the text frame\r\n    },\r\n    async attachSignature(){\r\n      const canvas = this.$refs['pageCanvas_' + this.selectedPage][0]; \r\n      const canvasState = canvas.toDataURL();\r\n      this.canvasHistory.push(canvasState);\r\n      this.canvasIndex = this.canvasHistory.length - 1;     \r\n      var ctx=canvas.getContext(\"2d\");\r\n      const tempImg = new Image();\r\n  \r\n      tempImg.src = this.sign.file;         \r\n      await new Promise(resolve => tempImg.onload = resolve);\r\n\r\n      const signatureWidth = tempImg.width; // Actual width in pixels\r\n      const signatureHeight = tempImg.height; // Actual height in pixel\r\n      const mx = this.pdfScale-0.5\r\n      const scaledX = this.sign.x * mx;\r\n      const scaledY = this.sign.y * (this.pdfScale -0.2);\r\n      const scaledW = this.sign.w * mx;\r\n      const scaledH = this.sign.h * mx;      \r\n      const ky = 0\r\n      const kx = 0//175\r\n      ctx.drawImage(this.$refs.signature,0,0,signatureWidth,signatureHeight,scaledX-kx, scaledY+ky,scaledW,scaledH);                \r\n      this.activateSign = false\r\n    },\r\n    undo() {\r\n      if (this.canvasIndex > -1) {\r\n        const prevState = this.canvasHistory[this.canvasIndex];\r\n        this.canvasIndex -= 1;\r\n        const canvas = this.$refs['pageCanvas_' + this.selectedPage][0];\r\n        const ctx = canvas.getContext('2d');\r\n        const img = new Image();\r\n\r\n        img.onload = () => {\r\n          ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n          ctx.drawImage(img, 0, 0);\r\n        };\r\n\r\n        img.src = prevState;\r\n      }\r\n    },\r\n    async submitSignedPdf() {\r\n      if (!this.sign.file) {\r\n        showModal({ text: \"Please select a signature.\" });\r\n        return;\r\n      }\r\n\r\n      //await this.attachSignature()\r\n\r\n      const pdfWidth = 595; // A4 width in points\r\n      const pdfHeight = 842; // A4 height in points\r\n\r\n      const newPdfDoc = await PDFDocument.create();\r\n\r\n      for (let pageIndex = 0; pageIndex < this.pdfPages.length; pageIndex++) {\r\n        const canvas = this.$refs['pageCanvas_' + pageIndex][0];\r\n       // const canvasRect = canvas.getBoundingClientRect();\r\n        const imageData = canvas.toDataURL(\"image/png\");\r\n        const image = await newPdfDoc.embedPng(imageData);\r\n        const newPage = newPdfDoc.addPage([pdfWidth, pdfHeight]);\r\n        newPage.drawImage(image, {\r\n          x: 0,\r\n          y: 0,\r\n          width: pdfWidth,\r\n          height: pdfHeight,\r\n        });      \r\n      }\r\n\r\n      // Iterate through each page and add to the PDF\r\n      pdfjsLib.GlobalWorkerOptions.workerSrc = pdfjsWorker;\r\n\r\n      // Save the new PDF bytes\r\n      const newPdfBytes = await newPdfDoc.save();\r\n\r\n      // Convert the PDF bytes to a Blob\r\n      const pdfBlob = new Blob([newPdfBytes], { type: \"application/pdf\" });           \r\n      const formData = new FormData();\r\n      formData.append(\"file\", pdfBlob);\r\n      formData.append(\"folder_name\", \"AgreementLetters\");\r\n      let res = await postFormData('file_upload',formData, true) \r\n      const userInfo =  this.userInfo\r\n      const url = res.responseBody\r\n      this.userInfo.university.agreement_letter.url = url\r\n      let res2 = await post('sign_agreement',{id:userInfo.university.id,platform:'university', url:url}, true)        \r\n      if(res2?.message){\r\n        console.log(this.userInfo.university)\r\n        localStorage.removeItem('userInfo')\r\n        localStorage.setItem('userInfo', JSON.stringify(this.userInfo))\r\n        showModal({text:\"Signature added to PDF and PDF saved.\"});\r\n      }      \r\n    },\r\n  },\r\n\r\n  async created() {\r\n    if(this.userInfo.university.agreement_letter){\r\n      try{\r\n\r\n        \r\n        await this.loadPdf();\r\n        pdfjsLib.GlobalWorkerOptions.workerSrc = pdfjsWorker;\r\n        Array.from({ length: pdfDocument.numPages }, (_, pageIndex) =>\r\n          pdfDocument.getPage(pageIndex + 1).then(async (page) => {\r\n            const canvas = this.$refs[\"pageCanvas_\" + pageIndex][0];\r\n            const context = canvas.getContext(\"2d\");        \r\n            const viewport = page.getViewport({ scale: this.pdfScale });\r\n            canvas.height = viewport.height;\r\n            canvas.width = viewport.width;\r\n            await page.render({\r\n              canvasContext: context,\r\n              viewport,\r\n              enableWebGL: false,\r\n            });\r\n          })\r\n        );\r\n      }catch(e){\r\n        this.userInfo.university.agreement_letter = null\r\n        showModal({text:'Agreement let yet to be sent'})\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.$nextTick(() => {\r\n      $(this.$refs.draggableresizableimage).resizable({\r\n        handles: {\r\n          nw: \".tl\",\r\n          ne: \".tr\",\r\n          sw: \".bl\",\r\n          se: \".br\",\r\n          e: \".r\",\r\n          w: \".l\",\r\n        },\r\n        minHeight: 70,\r\n        minWidth: 100,\r\n        autoHide: true,\r\n        stop: (event, ui) => {\r\n          // This function is called when dragging stops\r\n          this.sign.w = ui.size.width;\r\n          this.sign.h = ui.size.height;\r\n        },\r\n      });\r\n      $(this.$refs.draggableresizableimage2).resizable({\r\n        handles: {\r\n          nw: \".tl\",\r\n          ne: \".tr\",\r\n          sw: \".bl\",\r\n          se: \".br\",\r\n          e: \".r\",\r\n          w: \".l\",\r\n        },\r\n        minHeight: 70,\r\n        minWidth: 100,\r\n        autoHide: true,\r\n        stop: (event, ui) => {\r\n          // This function is called when dragging stops\r\n          this.text.fontSize = ui.size.height;          \r\n        },\r\n      });\r\n      \r\n      \r\n      $(this.$refs.draggableresizableimage).draggable({\r\n        stop: (event, ui) => {    \r\n          const canvas = this.$refs['pageCanvas_' + this.selectedPage][0];\r\n          const canvasOffset = $(canvas).position();\r\n          const canvasLeft = canvasOffset.left;\r\n          const canvasTop = canvasOffset.top;   \r\n          this.sign.x = ui.position.left - canvasLeft;\r\n          this.sign.y = ui.position.top - canvasTop;\r\n        },\r\n      });\r\n\r\n      $(this.$refs.draggableresizableimage2).draggable({\r\n        stop: (event, ui) => {\r\n          const canvas = this.$refs['pageCanvas_' + this.selectedPage][0];\r\n          const canvasOffset = $(canvas).position();\r\n          //console.log($(canvas).position(), $(canvas).offset(),ui.position);\r\n          const canvasLeft = canvasOffset.left;\r\n          const canvasTop = canvasOffset.top;   \r\n          this.text.x = ui.position.left - canvasLeft;\r\n          this.text.y = ui.position.top - canvasTop;\r\n        },\r\n      });\r\n      });\r\n  },\r\n};\r\n</script> \r\n  \r\n<style scoped>\r\n.pdf-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin: 20px;\r\n}\r\n\r\n.pdf-viewer {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  margin: 20px 0;\r\n}\r\n\r\n.page-thumbnail {\r\n  margin: 10px;\r\n}\r\n\r\ncontainer {\r\n  padding: 1em;\r\n  border: 1px solid lightgrey;\r\n  margin: 1em;\r\n  border-radius: 4px;\r\n}\r\n\r\ninput[type=\"button\"], button {\r\n  background-color: lightgray;\r\n  border: 0;\r\n  border-radius: 4px;\r\n  padding: 0.5em 2em;\r\n}\r\n\r\n#myFileInput {\r\n  display: none;\r\n}\r\n\r\n.label {\r\n  display: block;\r\n  margin-top: 0.5em;\r\n}\r\n\r\n.l {\r\n  left: -4px;\r\n  top: calc(50% - 10px);\r\n  cursor: w-resize;\r\n}\r\n\r\n.r {\r\n  right: -4px;\r\n  top: calc(50% - 10px);\r\n  cursor: e-resize;\r\n}\r\n\r\n.tl {\r\n  left: -6px;\r\n  top: -6px;\r\n  cursor: nw-resize;\r\n}\r\n\r\n.tr {\r\n  right: -6px;\r\n  top: -6px;\r\n  cursor: ne-resize;\r\n}\r\n\r\n.bl {\r\n  left: -6px;\r\n  bottom: -6px;\r\n  cursor: sw-resize;\r\n}\r\n\r\n.br {\r\n  right: -6px;\r\n  bottom: -6px;\r\n  cursor: se-resize;\r\n}\r\n\r\n.ui-resizable-handle {\r\n  position: absolute;\r\n  width: 12px;\r\n  height: 12px;\r\n  background: rgb(255, 0, 106);\r\n  border-width: 1.5px;\r\n  border-style: solid;\r\n  border-color: rgb(255, 255, 255);\r\n  border-image: initial;\r\n  border-radius: 999px;\r\n}\r\n\r\n.resizable-wrapper {\r\n  width: 8px;\r\n  height: 16px;\r\n}\r\n\r\n.ui-widget-content {\r\n  cursor: move;\r\n}\r\n\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.1);\r\n  z-index: 101;\r\n}\r\n\r\n.modal-custom {\r\n  position: fixed;\r\n  top: 45%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  width: 80%;\r\n  height: 80%;\r\n  background-color: white;\r\n  border-radius: 5px;\r\n  z-index: 5000;\r\n}\r\n\r\n.modal-header {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n}\r\n\r\n.modal-close {\r\n  border: none;\r\n  background-color: transparent;\r\n  font-size: 1.5rem;\r\n  cursor: pointer;\r\n}\r\n\r\n.modal-body {\r\nheight: 80vh;\r\n  background: white;\r\n}\r\n\r\niframe {\r\n  width: 100%;\r\n  height: 100%;\r\n  border: none;\r\n}\r\n.modal-overlay::before {\r\n    content: \"\";\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    backdrop-filter: blur(3px);\r\n}\r\n</style>\r\n","import { render } from \"./OldAgreementLetter.vue?vue&type=template&id=6ee42b42&scoped=true\"\nimport script from \"./OldAgreementLetter.vue?vue&type=script&lang=js\"\nexport * from \"./OldAgreementLetter.vue?vue&type=script&lang=js\"\n\nimport \"./OldAgreementLetter.vue?vue&type=style&index=0&id=6ee42b42&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6ee42b42\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"px-3 row\">\r\n    <div class=\"offset-md-2 col-md-8\">\r\n      <div class=\"d-flex mb-3 row\">\r\n        <div class=\"col-md-6\">\r\n          <h4>Sign Here</h4>\r\n          <div id=\"parentDiv\" class=\"border\" ref=\"signatureCanvas\" width=\"100%\" height=\"200\"></div>\r\n        </div>      \r\n        <div class=\"col-md-6 mb-3 \" >\r\n          <h4 >Output</h4>          \r\n          <div class=\"border\" style=\"width:100%;height:200px\">\r\n            <img ref=\"signature\" src=\"\" alt=\"\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <button\r\n        class=\"btn btn-sm d-inline-block mx-1 btn-warning\"\r\n        @click=\"clearSignature\"\r\n      >\r\n        Clear\r\n      </button>\r\n      <button\r\n        class=\"btn btn-sm d-inline-block mx-1 btn-warning\"\r\n        @click=\"captureSignature\"\r\n      >\r\n        Capture Signature\r\n      </button>\r\n    </div>\r\n    <div class=\"col-md-2\"></div>\r\n    <div class=\"col-md-12\">\r\n      <center>\r\n        <button @click=\"useSignature\" class=\"btn mx-auto d-inline  btn-warning mt-5\">Use Signature</button>\r\n      </center>\r\n    </div>\r\n  </div>\r\n</template>\r\n  \r\n  <script>\r\nimport p5 from \"p5\";\r\nimport { useUserStore } from \"@/stores/user\";\r\nvar sketch = null;\r\nexport default {\r\n  name: \"signatureView\",\r\n  data() {\r\n    return {\r\n        store:useUserStore(),\r\n        signUrl:null,\r\n    };\r\n  },\r\n  methods: {\r\n    useSignature(){\r\n      this.$emit('getSign', this.signUrl)\r\n    },\r\n    initializeCanvas() {\r\n      sketch = new p5(this.drawSignature, this.$refs.signatureCanvas);\r\n    },\r\n    drawSignature(p) {\r\n      let drawing = false;\r\n      let lastX = 0;\r\n      let lastY = 0;\r\n\r\n      p.setup = () => {\r\n        const parentDiv = document.getElementById('parentDiv'); // Replace 'parentDiv' with the actual ID of the parent div\r\n        p.createCanvas(parentDiv.clientWidth, 200);\r\n        p.frameRate(3);\r\n        p.strokeWeight(2);\r\n        p.noFill();\r\n        p.background(255);\r\n      };\r\n\r\n      p.mousePressed = () => {\r\n        drawing = true;\r\n        lastX = p.mouseX;\r\n        lastY = p.mouseY;\r\n      };\r\n\r\n      p.mouseReleased = () => {\r\n        drawing = false;\r\n      };\r\n      p.touchMoved = () => {\r\n        p.line(p.mouseX, p.mouseY, lastX, lastY);\r\n        lastX = p.mouseX;\r\n        lastY = p.mouseY;\r\n        return false;\r\n      };\r\n      p.draw = () => {\r\n        if (drawing) {\r\n          p.line(lastX, lastY, p.mouseX, p.mouseY);\r\n          lastX = p.mouseX;\r\n          lastY = p.mouseY;\r\n          return false;\r\n        }\r\n      };\r\n    },\r\n    clearSignature() {\r\n      sketch.clear();\r\n      sketch.background(255);\r\n    },\r\n    getSignatureData() {\r\n      return this.$refs.signatureCanvas.toDataURL();\r\n    },\r\n    captureSignature() {         \r\n        const myImage = new Image();\r\n        myImage.crossOrigin = \"Anonymous\";\r\n        this.store.isLoading = true;            \r\n        const canvas = this.$refs.signatureCanvas.getElementsByTagName('canvas')[0];\r\n        const context = canvas.getContext(\"2d\");\r\n        myImage.onload = () => {\r\n            // Create an offscreen canvas to capture the image\r\n            \r\n            canvas.width = myImage.width;\r\n            canvas.height = myImage.height;\r\n            \r\n            // Draw the image on the offscreen canvas\r\n            context.drawImage(myImage, 0, 0);\r\n            \r\n            // Remove blanks and get cropped image data\r\n            const croppedImageData = this.removeImageBlanks(canvas);\r\n            console.log(\"Cropped Image Data:\", croppedImageData);\r\n            this.$refs.signature.src = croppedImageData\r\n            this.signUrl =croppedImageData\r\n            this.store.isLoading = false;\r\n        };        \r\n        myImage.src = canvas.toDataURL();\r\n    },    \r\n    removeImageBlanks(imageObject) {\r\n        let imgWidth = imageObject.width;\r\n        let imgHeight = imageObject.height;\r\n        var canvas = document.createElement('canvas');\r\n        canvas.setAttribute(\"width\", imgWidth);\r\n        canvas.setAttribute(\"height\", imgHeight);\r\n        var context = canvas.getContext('2d');\r\n        context.drawImage(imageObject, 0, 0);\r\n\r\n       var imageData = context.getImageData(0, 0, imgWidth, imgHeight),\r\n        data = imageData.data,\r\n        getRBG = function(x, y) {\r\n            var offset = imgWidth * y + x;\r\n            return {\r\n                red:     data[offset * 4],\r\n                green:   data[offset * 4 + 1],\r\n                blue:    data[offset * 4 + 2],\r\n                opacity: data[offset * 4 + 3]\r\n            };\r\n        },\r\n        isWhite = function (rgb) {\r\n            // many images contain noise, as the white is not a pure #fff white\r\n            return rgb.red > 200 && rgb.green > 200 && rgb.blue > 200;\r\n        },\r\n                scanY = function (fromTop) {\r\n        var offset = fromTop ? 1 : -1;\r\n\r\n        // loop through each row\r\n        for(var y = fromTop ? 0 : imgHeight - 1; fromTop ? (y < imgHeight) : (y > -1); y += offset) {\r\n\r\n            // loop through each column\r\n            for(var x = 0; x < imgWidth; x++) {\r\n                var rgb = getRBG(x, y);\r\n                if (!isWhite(rgb)) {\r\n                    if (fromTop) {\r\n                        return y;\r\n                    } else {\r\n                        return Math.min(y + 1, imgHeight);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null; // all image is white\r\n    },\r\n    scanX = function (fromLeft) {\r\n        var offset = fromLeft? 1 : -1;\r\n\r\n        // loop through each column\r\n        for(var x = fromLeft ? 0 : imgWidth - 1; fromLeft ? (x < imgWidth) : (x > -1); x += offset) {\r\n\r\n            // loop through each row\r\n            for(var y = 0; y < imgHeight; y++) {\r\n                var rgb = getRBG(x, y);\r\n                if (!isWhite(rgb)) {\r\n                    if (fromLeft) {\r\n                        return x;\r\n                    } else {\r\n                        return Math.min(x + 1, imgWidth);\r\n                    }\r\n                }      \r\n            }\r\n        }\r\n        return null; // all image is white\r\n    };\r\n\r\n    var cropTop = scanY(true),\r\n        cropBottom = scanY(false),\r\n        cropLeft = scanX(true),\r\n        cropRight = scanX(false),\r\n        cropWidth = cropRight - cropLeft,\r\n        cropHeight = cropBottom - cropTop;\r\n\r\n    canvas.setAttribute(\"width\", cropWidth);\r\n    canvas.setAttribute(\"height\", cropHeight);\r\n    // finally crop the guy\r\n    canvas.getContext(\"2d\").drawImage(imageObject,\r\n        cropLeft, cropTop, cropWidth, cropHeight,\r\n        0, 0, cropWidth * 0.50, cropHeight * 0.50);\r\n\r\n    return canvas.toDataURL();\r\n} \r\n  },\r\n  mounted() {\r\n    this.initializeCanvas();\r\n  },\r\n};\r\n</script>\r\n  ","import { render } from \"./Signature.vue?vue&type=template&id=79c8e1a0\"\nimport script from \"./Signature.vue?vue&type=script&lang=js\"\nexport * from \"./Signature.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","style","_createElementVNode","_hoisted_4","ref","id","src","alt","_hoisted_19","$data","userInfo","university","agreement_letter","_createElementBlock","_hoisted_1","url","_hoisted_2","onChange","_cache","args","$options","handleFileUpload","type","onClick","$event","_ctx","$refs","click","value","showModal","tite","innerHTML","$globals","icons","pen","showTextFrame","title","canvasIndex","undo","submitSignedPdf","_hoisted_6","href","download","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","attachSignature","activateSign","_hoisted_17","_hoisted_18","rows","cols","text","_normalizeStyle","fontSize","_hoisted_25","attachText","_Fragment","_renderList","pdfPages","page","pageIndex","key","onMousemove","handleCanvasClick","height","_hoisted_32","closeModal","_hoisted_33","_hoisted_34","_hoisted_35","_createVNode","_component_Signature","onGetSign","importSign","_hoisted_36","$","jquery","pdfDocument","components","Signature","data","pdfData","pdfUrl","signaturePosition","selectedPage","x","y","w","h","sign","file","pdfScale","JSON","parse","localStorage","getItem","canvasHistory","methods","this","event","target","files","signature","URL","createObjectURL","doc","loadPdf","template","pdfjsLib","workerSrc","pdfjsWorker","loadingTask","promise","Array","from","length","numPages","_","getPage","e","console","log","canvas","ctx","getContext","canvasState","toDataURL","push","font","mx","scaledX","scaledY","fillStyle","fillText","tempImg","Image","Promise","resolve","onload","signatureWidth","width","signatureHeight","scaledW","scaledH","ky","kx","drawImage","prevState","img","clearRect","pdfWidth","pdfHeight","newPdfDoc","PDFDocument","create","imageData","image","embedPng","newPage","addPage","newPdfBytes","save","pdfBlob","Blob","formData","FormData","append","res","postFormData","responseBody","res2","post","platform","message","removeItem","setItem","stringify","created","then","async","context","viewport","getViewport","scale","render","canvasContext","enableWebGL","mounted","$nextTick","draggableresizableimage","resizable","handles","nw","ne","sw","se","minHeight","minWidth","autoHide","stop","ui","size","draggableresizableimage2","draggable","canvasOffset","position","canvasLeft","left","canvasTop","top","__exports__","_hoisted_3","_hoisted_5","clearSignature","captureSignature","_hoisted_12","_component_center","useSignature","sketch","name","store","useUserStore","signUrl","$emit","initializeCanvas","p5","drawSignature","signatureCanvas","p","drawing","lastX","lastY","setup","parentDiv","document","getElementById","createCanvas","clientWidth","frameRate","strokeWeight","noFill","background","mousePressed","mouseX","mouseY","mouseReleased","touchMoved","line","draw","clear","getSignatureData","myImage","crossOrigin","isLoading","getElementsByTagName","croppedImageData","removeImageBlanks","imageObject","imgWidth","imgHeight","createElement","setAttribute","getImageData","getRBG","offset","red","green","blue","opacity","isWhite","rgb","scanY","fromTop","Math","min","scanX","fromLeft","cropTop","cropBottom","cropLeft","cropRight","cropWidth","cropHeight"],"sourceRoot":""}